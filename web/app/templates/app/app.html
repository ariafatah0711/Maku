{% extends "base.html" %} {% load humanize %} {% block title %}App -
MaKu{%endblock %} {% block content %}

<div class="max-w-5xl mx-auto">
  <!-- HEADER -->
  <div class="mb-8">
    <h1 class="text-4xl font-bold text-slate-800 mb-2">Manajemen Transaksi</h1>
    <div class="flex justify-between items-center">
      <p class="text-slate-500">Catat dan kelola transaksi keuangan Anda</p>
      <a
        href="{% url 'app:export' %}"
        class="text-sm bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-medium">
        ğŸ“¥ Export
      </a>
    </div>
  </div>

  <!-- SUMMARY CARDS -->
  {% if totals %}
  <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
    <!-- Total Income -->
    <div
      class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow p-6 border-l-4 border-green-600">
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm text-green-600 font-medium">Total Pemasukan</p>
          <h3 class="text-2xl font-bold text-green-700 mt-1">
            Rp {{ totals.total_income|intcomma }}
          </h3>
        </div>
        <div class="text-3xl">ğŸ“ˆ</div>
      </div>
    </div>

    <!-- Total Expense -->
    <div
      class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl shadow p-6 border-l-4 border-red-600">
      <div class="flex justify-between items-start">
        <div>
          <p class="text-sm text-red-600 font-medium">Total Pengeluaran</p>
          <h3 class="text-2xl font-bold text-red-700 mt-1">
            Rp {{ totals.total_expense|intcomma }}
          </h3>
        </div>
        <div class="text-3xl">ğŸ“‰</div>
      </div>
    </div>

    <!-- Balance -->
    <div
      class="bg-gradient-to-br {% if totals.balance >= 0 %}from-blue-50 to-blue-100{% else %}from-orange-50 to-orange-100{% endif %} rounded-xl shadow p-6 border-l-4 {% if totals.balance >= 0 %}border-blue-600{% else %}border-orange-600{% endif %}">
      <div class="flex justify-between items-start">
        <div>
          <p
            class="text-sm {% if totals.balance >= 0 %}text-blue-600{% else %}text-orange-600{% endif %} font-medium">
            Saldo
          </p>
          <h3
            class="text-2xl font-bold {% if totals.balance >= 0 %}text-blue-700{% else %}text-orange-700{% endif %} mt-1">
            Rp {{ totals.balance|intcomma }}
          </h3>
        </div>
        <div class="text-3xl">ğŸ’°</div>
      </div>
    </div>
  </div>
  {% endif %}

  <!-- FORM -->
  <div class="bg-white rounded-xl shadow p-6 mb-10">
    <h2 class="text-lg font-semibold text-slate-700 mb-4">Tambah Transaksi</h2>

    <form method="post" class="grid grid-cols-1 md:grid-cols-6 gap-4">
      {% csrf_token %}

      <input
        type="date"
        name="date"
        required
        class="md:col-span-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />

      <select
        name="type"
        class="md:col-span-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
      </select>

      <input
        type="text"
        name="category"
        placeholder="Kategori"
        class="md:col-span-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />

      <input
        type="number"
        name="amount"
        placeholder="Jumlah"
        required
        class="md:col-span-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />

      <input
        type="text"
        name="note"
        placeholder="Catatan"
        class="md:col-span-1 border rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500" />

      <button
        type="submit"
        class="md:col-span-1 bg-blue-600 text-white rounded-lg py-2 hover:bg-blue-700 transition font-medium">
        Tambah
      </button>
    </form>
  </div>

  <!-- TABLE -->
  <div class="bg-white rounded-xl shadow overflow-hidden">
    {% if error %}
    <div class="p-4 text-red-600 font-medium">{{ error }}</div>
    {% endif %}
    <table class="w-full text-sm">
      <thead class="bg-slate-50 text-slate-600">
        <tr>
          <th class="px-4 py-3 text-left">Tanggal</th>
          <th class="px-4 py-3 text-left">Jenis</th>
          <th class="px-4 py-3 text-left">Kategori</th>
          <th class="px-4 py-3 text-right">Jumlah</th>
          <th class="px-4 py-3 text-left">Catatan</th>
          <th class="px-4 py-3 text-center">Aksi</th>
        </tr>
      </thead>

      <tbody>
        {% for t in transactions %}
        <tr class="border-t hover:bg-slate-50">
          <td class="px-4 py-3">{{ t.date }}</td>

          <td class="px-4 py-3">
            {% if t.type == "income" %}
            <span class="text-green-600 font-medium">Income</span>
            {% else %}
            <span class="text-red-600 font-medium">Expense</span>
            {% endif %}
          </td>

          <td class="px-4 py-3">{{ t.category|default:"-" }}</td>

          <td class="px-4 py-3 text-right font-medium">
            Rp {{ t.amount|intcomma }}
          </td>

          <td class="px-4 py-3 text-slate-500">{{ t.note|default:"-" }}</td>
          <td class="px-4 py-3 text-center space-x-2">
            <a
              href="{% url 'app:edit' t.id %}"
              class="text-blue-600 hover:text-blue-800"
              >âœï¸</a
            >
            <a
              href="{% url 'app:delete' t.id %}"
              onclick="return confirm('Hapus transaksi ini?')"
              class="text-red-600 hover:text-red-800"
              >ğŸ—‘</a
            >
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="6" class="py-8 text-center text-slate-400">
            Belum ada transaksi. Mulai dengan menambahkan transaksi baru!
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
